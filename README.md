# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ Lua

- üî¨ –ú–∏–Ω–∏–º–∞–ª–∏–∑–º
- üöÄ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–æ—Ç–µ–Ω –∏–ª–∏ —Ç—ã—Å—è—á http –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- üîí –ü–æ–¥–¥–µ—Ä–∂–∫–∞ https
- üôÖ‚Äç‚ôÇÔ∏è Nginx –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
- üêç –£–¥–æ–±–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ `http_requests.lua`, –ø–æ–¥–æ–±–Ω–∞ –ø–∏—Ç–æ–Ω–æ–≤—Å–∫–æ–π requests
- üì¶ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ `multipart/form-data` –∑–∞–ø—Ä–æ—Å–æ–≤
- ü§ñ –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ø–∞—Ä—Å–µ—Ä–æ–≤, —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–æ–≤, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö API –±–∏–±–ª–∏–æ—Ç–µ–∫
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –õ–µ–≥–∫–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–∂–µ –≤ Garry's Mod


## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

> `luarocks install lua-requests-async`

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ [–∑–¥–µ—Å—å](/examples)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

```lua
-- http_async.lua
local http = require("http_async")
http.request({
	url        = "https://httpbin.org/post?foo=bar",
	method     = "POST",
	body       = "body payload",
	success    = function(code, body, headers)
		assert(code == 200)
		assert(headers["connection"] == "close")
		print(body)
	end,
})

require("copas").loop()
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±–µ—Ä—Ç–∫–∏-—Ö–µ–ª–ø–µ—Ä–∞

```lua
-- http_requests.lua
local requests = require("http_requests")

requests.get({"https://httpbin.org/get", {key = "val"}}, function(res)
	print(res.content)
end)

require("copas").loop()
```

–í –ª—é–±–æ–º —Å–ª—É—á–∞–µ –≤ –≤–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ –≥–ª–∞–≤–Ω–æ–º —Ñ–∞–π–ª–µ –≤ –∫–æ–Ω—Ü–µ, **–¥–æ–ª–∂–Ω–∞** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ–¥–Ω–∞ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π:

```lua
-- –í—ã–ø–æ–ª–Ω–∏—Ç –≤—Å–µ –Ω–∞–∫–æ–ø–∏–≤—à–∏–µ—Å—è http –∑–∞–ø—Ä–æ—Å—ã –∏ –∑–∞–≤–µ—Ä—à–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞
require("copas").loop()

-- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å–∞–º–æ –ø–æ —Å–µ–±–µ
while true do require("copas").step() end
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–∫–∞ —á—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–µ—Ç, –Ω–æ –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª –¥–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∏ –≤ –Ω–∏—Ö –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã, –∞ —Ç–∞–∫–∂–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤. –ü—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∏ –Ω–∞–π–¥–∏—Ç–µ –Ω—É–∂–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é. –ú–æ–∂–µ—Ç–µ —Ç–∞–∫–∂–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏–º–µ—Ä–∞–º–∏

## TODO

- –î–æ–±–∞–≤–∏—Ç—å –Ω–∞ readme —Å–ø–∏—Å–æ–∫ —Ç–µ—Ö, –∫—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä git.io/ggram
- –í—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É [multipart](/examples/sending_multipart.lua) "–∏–∑ –∫–æ—Ä–æ–±–∫–∏" –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é —á—Ç–æ-—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å
- –î–æ–±–∞–≤–ª—è—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–∑ –ø–∏—Ç–Ω–æ–≤—Å–∫–æ–≥–æ requests
- (?) –°–¥–µ–ª–∞—Ç—å –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –∫–∞–∫ –≤ –∫–æ—Ä—É—Ç–∏–Ω–∞—Ö, —Ç–∞–∫ –∏ –±–µ–∑ –Ω–∏—Ö. –° –∫–æ–ª–ª–±–µ–∫–∞–º–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –æ–±–µ—Ä—Ç–∫–∏
- (?) –ï—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–µ—Ä—Ö–Ω–µ–µ, —Ç–æ –±–µ–∑ copas, –≤–µ—Ä–æ—è—Ç–Ω–æ, –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –æ–±–æ–π—Ç–∏—Å—å (–Ω–æ –µ—Å—Ç—å –ª–∏ —Å–º—ã—Å–ª)
